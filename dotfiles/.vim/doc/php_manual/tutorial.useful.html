<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <title>実用的な例</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
 </head>
 <body><div style="text-align: center;">
 <div class="prev" style="float: left;"><a href="tutorial.firstpage.html">PHP を使用する初めてのページ</a></div>
 <div class="next" style="float: right;"><a href="tutorial.forms.html">フォームの処理</a></div>
 <div class="up"><a href="tutorial.html">簡易チュートリアル</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div><hr /><div id="tutorial.useful" class="sect1">
   <h2 class="title">実用的な例</h2>
   <p class="para">
    次に、より実用的なことをしてみましょう。
    ページを見ているユーザが使用しているブラウザの種類を確認してみます。
    これを行なうには、ブラウザが
    HTTP リクエストの一部として送信した user agent 文字列を調べます。
    この情報は、<a href="language.variables.html" class="link">変数</a>
    に保存されています。PHP では、変数名は常にドル記号で始まります。
    ここで使用する変数は、<var class="varname">$_SERVER[&#039;HTTP_USER_AGENT&#039;]</var>
    です。
   </p>
   <blockquote><p><b class="note">注意</b>: 
    
     <a href="reserved.variables.html#reserved.variables.server" class="link">$_SERVER</a> は、
     Web サーバ関連情報を全て保持する PHP の特別な予約変数です。詳細は、
     <a href="language.variables.predefined.html#language.variables.superglobals" class="link">スーパーグローバル</a>
     を参照してください。
     これらの特別な変数は、<a href="http://www.php.net/releases/4_1_0.php" class="link external">&raquo; 4.1.0</a>
     で導入されました。これ以前は、
     <var class="varname">$HTTP_SERVER_VARS</var> のような古い配列
     <var class="varname">$HTTP_*_VARS</var> を代わりに使用していました。
     古いとはいえ、これらの変数はまだ存在しています
     (<a href="tutorial.oldcode.html" class="link">古いコード</a>に関する注記も
     参照してください)。
    <br />
   </p></blockquote>
   <p class="para">
    この変数を表示するには、以下のようにします。
   </p>
   <p class="para">
    <div class="example">
    <p><b>Example#1 変数を出力する (配列要素)</b></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">[</span><span style="color: #DD0000">'HTTP_USER_AGENT'</span><span style="color: #007700">];<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>
      このスクリプトの出力例は以下のようになります。
     <div class="example-contents"><pre>
Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)
     </pre></div>
    </p></div>
   </div>
   </p>
   <p class="para">
    PHP で利用可能な変数の<a href="language.types.html" class="link">型</a>
    には多くの種類があります。上の例では、
    <a href="language.types.array.html" class="link">配列</a>
    の要素を出力しています。配列は、非常に有用です。
   </p>
   <p class="para">
    <var class="varname">$_SERVER</var> は、PHP
    で自動的に利用可能な変数のひとつに過ぎません。マニュアルの
    <a href="reserved.variables.html" class="link">定義済の変数</a>
    のセクションでリストを参照することができます。
    あるいは、完全なリストを取得するには、さきほどのセクションで使用した
    <a href="function.phpinfo.html" class="function">phpinfo()</a> 関数の出力を確認します。
   </p>
   <p class="para">
    PHP タグの中に複数の PHP 命令を置くことができ、echo
    文以上のことを行なうコードブロックを作成することができます。
    例えば、インターネット・エクスプローラかどうかを調べたい場合は、
    以下のようにします。
   </p>
   <p class="para">
    <div class="example">
     <p><b>Example#2 
      <a href="language.control-structures.html" class="link">制御構造</a> および
      <a href="language.functions.html" class="link">関数</a>の使用例
     </b></p>
     <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #007700">if&nbsp;(</span><span style="color: #0000BB">strpos</span><span style="color: #007700">(</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">[</span><span style="color: #DD0000">'HTTP_USER_AGENT'</span><span style="color: #007700">],&nbsp;</span><span style="color: #DD0000">'MSIE'</span><span style="color: #007700">)&nbsp;!==&nbsp;</span><span style="color: #0000BB">false</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">'あなたはInternet&nbsp;Explorerを使用しています&lt;br&nbsp;/&gt;'</span><span style="color: #007700">;<br />}<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
     </div>

     <div class="example-contents"><p>
      このスクリプトの出力例は以下のようになります。
      <div class="example-contents"><pre>
<div class="cdata"><pre>
あなたはInternet Explorerを使用しています&lt;br /&gt;
</pre></div>
      </pre></div>
     </p></div>
    </div>
   </p>
   <p class="para">
    ここで、新しい概念をいくつか導入します。
    <a href="control-structures.if.html" class="link">if</a> 文を使用しています。
    C 言語の基本構文を知っているとしたら、理解できると思います。
    C 言語や上記の構文を使用する他の言語をあまり知らない場合には、
    PHP の入門書を手にとって最初の数章を読むか、このマニュアルの
    <a href="langref.html" class="link">言語リファレンス</a>の部分を読むべきです。
   </p>
   <p class="para">
    二番目の新しい概念は、<a href="function.strpos.html" class="function">strpos()</a> 関数のコールです。
    <a href="function.strpos.html" class="function">strpos()</a> は PHP に組み込まれた関数で、
    文字列の中である文字列を探します。この場合、
    <var class="varname">$_SERVER[&#039;HTTP_USER_AGENT&#039;]</var> (いわゆる干し草の山
    【haystack】) の中で
    <i class="literal">&quot;MSIE&quot;</i> (いわゆる針【needle】) を探しています。
    この文字列が見つかった場合、
    この関数はこの関数は文字列の相対的な位置を返し、
    見つからなかった場合には <b><tt>FALSE</tt></b> を返します。
    この関数が <b><tt>FALSE</tt></b> を返さなければ、
    <a href="control-structures.if.html" class="link">if</a>
    文は <b><tt>TRUE</tt></b> と評価し、その{波括弧}の中のコードが実行されます。
    そうでない場合は、実行されません。
    <a href="control-structures.if.html" class="link">if</a>,
    <a href="control-structures.else.html" class="link">else</a> と
    <a href="function.strtoupper.html" class="function">strtoupper()</a> や <a href="function.strlen.html" class="function">strlen()</a>
    のような他の関数で、似たような例を作ってみてください。
    関連するマニュアルの各ページにも例がのっています。
    関数の使用法に自信がない場合には、マニュアルの
    <a href="about.prototypes.html" class="link">関数定義の読み方</a>および
    <a href="language.functions.html" class="link">PHP関数</a>のセクションの両方を
    読んでみると良いでしょう。
   </p>
   <p class="para">
    この例を少し発展させて、PHP ブロックの中からでも PHP
    モードから出たり入ったりすることができることを以下に示します。
   </p>
   <p class="para">
    <div class="example">
     <p><b>Example#3 HTML および PHP モードの両方を混在させる</b></p>
     <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #007700">if&nbsp;(</span><span style="color: #0000BB">strpos</span><span style="color: #007700">(</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">[</span><span style="color: #DD0000">'HTTP_USER_AGENT'</span><span style="color: #007700">],&nbsp;</span><span style="color: #DD0000">'MSIE'</span><span style="color: #007700">)&nbsp;!==&nbsp;</span><span style="color: #0000BB">false</span><span style="color: #007700">)&nbsp;{<br /></span><span style="color: #0000BB">?&gt;<br /></span>&lt;h3&gt;strposが非falseを返しました&lt;/h3&gt;<br />&lt;center&gt;&lt;b&gt;あなたはInternet&nbsp;Explorerを使用しています&lt;/b&gt;&lt;/center&gt;<br /><span style="color: #0000BB">&lt;?php<br /></span><span style="color: #007700">}&nbsp;else&nbsp;{<br /></span><span style="color: #0000BB">?&gt;<br /></span>&lt;h3&gt;strposがfalseを返しました&lt;/h3&gt;<br />&lt;center&gt;&lt;b&gt;あなたはInternet&nbsp;Explorerを使用していません&lt;/b&gt;&lt;/center&gt;<br /><span style="color: #0000BB">&lt;?php<br /></span><span style="color: #007700">}<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
     </div>

     <div class="example-contents"><p>
      この例の出力は以下のようになります。
      <div class="example-contents"><pre>
<div class="cdata"><pre>
&lt;h3&gt;strposが非falseを返しました&lt;/h3&gt;
&lt;center&gt;&lt;b&gt;あなたはInternet Explorerを使用しています&lt;/b&gt;&lt;/center&gt;
</pre></div>
      </pre></div>
     </p></div>
    </div>
   </p>
   <p class="para">
    何かを出力する際に PHP の echo 文を使用する代わりに、PHP
    モードを抜けて通常の HTML を送信しています。ここで注意すべき重要で強力な点は、
    スクリプトの論理フローが損なわれないということです。
    <a href="function.strpos.html" class="function">strpos()</a> が <b><tt>TRUE</tt></b> または <b><tt>FALSE</tt></b>
    のどちらを返すか、言い換えると<i class="literal">MSIE</i>
    が見つかったかどうかに基づき、HTML
    ブロックだけが見る側に送信されることになります。
   </p>
  </div><hr /><div style="text-align: center;">
 <div class="prev" style="float: left;"><a href="tutorial.firstpage.html">PHP を使用する初めてのページ</a></div>
 <div class="next" style="float: right;"><a href="tutorial.forms.html">フォームの処理</a></div>
 <div class="up"><a href="tutorial.html">簡易チュートリアル</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div></body></html>
