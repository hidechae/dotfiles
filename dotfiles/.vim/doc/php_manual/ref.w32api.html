<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <title>W32api 関数</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
 </head>
 <body><div style="text-align: center;">
 <div class="prev" style="float: left;"><a href="function.vpopmail-set-user-quota.html">vpopmail_set_user_quota</a></div>
 <div class="next" style="float: right;"><a href="function.w32api-deftype.html">w32api_deftype</a></div>
 <div class="up"><a href="funcref.html">関数リファレンス</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div><hr /><div>
  <h1 class="title">W32api 関数</h1>
  

  <div class="partintro">
   <div id="w32api.intro" class="section">
    <h2 class="title">導入</h2>
    <p class="para">
     この拡張モジュールは、DLL への一般的な拡張 API です。この拡張モジュールは
     もともと PHP から Win32 API にアクセスできるようにするために
     作成されましたが、他の DLL によりエクスポートされている他の関数にも
     アクセスすることができます。
    </p>
    <p class="para">
     現在サポートされている型は、一般の PHP 型 (文字列, boolean, float,
     整数, NULL) と <a href="function.w32api-deftype.html" class="function">w32api_deftype()</a> で定義した型です。
    </p>
    <blockquote><p><b class="note">注意</b>: 
     
      
この拡張モジュールは <a href="http://pecl.php.net/" class="link external">&raquo; PECL</a> レポジトリに移動
されており、以下のバージョン以降 PHP にバンドルされなくなっています。 PHP 5.1.0.
     <br />
    </p></blockquote>
    <div class="warning"><b class="warning">警告</b><p class="simpara">この拡張モジュールは、
<em class="emphasis">実験的</em> なものです。この拡張モジュールの動作・
関数名・その他ドキュメントに書かれている事項は、予告なく、将来的な PHP
のリリースにおいて変更される可能性があります。
このモジュールは自己責任で使用してください。</p></div>
   </div>

   <div id="w32api.requirements" class="section">
    <h2 class="title">要件</h2>
    <p class="para">
     この拡張モジュールは Windows システムでのみ動作します。
    </p>
   </div>
   
   <div id="w32api.installation" class="section">
    <h2 class="title">インストール手順</h2>
    <p class="para">PHP コアに含まれるため、
追加のインストール無しで使用できます。</p>
   </div>
   
   <div id="w32api.configuration" class="section">
    <h2 class="title">実行時設定</h2>
    <p class="para">設定ディレクティブは定義されていません。</p>
   </div>

   <div id="w32api.resources" class="section">
    <h2 class="title">リソース型</h2>
    <p class="para">
     この拡張モジュールは 1 種類のリソース型を定義し、ユーザ定義型で
     使用されます。このリソースの名前は <i class="literal">&quot;dynaparm&quot;</i>
     です。
    </p>
   </div>

   


<div id="w32api.constants" class="section">
 <h2 class="title">定義済み定数</h2>
 <p class="simpara">
以下の定数が定義されています。
この関数の拡張モジュールが PHP 組み込みでコンパイルされているか、
実行時に動的にロードされている場合のみ使用可能です。
</p>
 <dl>

  <dt>

   <span class="term">
    <b><tt>DC_MICROSOFT</tt></b> 
    (<a href="language.types.integer.html" class="type integer">integer</a>)
   </span>
   <dd>

    <span class="simpara">
     
    </span>
   </dd>

  </dt>

  <dt>

   <span class="term">
    <b><tt>DC_BORLAND</tt></b> 
    (<a href="language.types.integer.html" class="type integer">integer</a>)
   </span>
   <dd>

    <span class="simpara">
     
    </span>
   </dd>

  </dt>

  <dt>

   <span class="term">
    <b><tt>DC_CALL_CDECL</tt></b> 
    (<a href="language.types.integer.html" class="type integer">integer</a>)
   </span>
   <dd>

    <span class="simpara">
     
    </span>
   </dd>

  </dt>

  <dt>

   <span class="term">
    <b><tt>DC_CALL_STD</tt></b> 
    (<a href="language.types.integer.html" class="type integer">integer</a>)
   </span>
   <dd>

    <span class="simpara">
     
    </span>
   </dd>

  </dt>

  <dt>

   <span class="term">
    <b><tt>DC_RETVAL_MATH4</tt></b> 
    (<a href="language.types.integer.html" class="type integer">integer</a>)
   </span>
   <dd>

    <span class="simpara">
     
    </span>
   </dd>

  </dt>

  <dt>

   <span class="term">
    <b><tt>DC_RETVAL_MATH8</tt></b> 
    (<a href="language.types.integer.html" class="type integer">integer</a>)
   </span>
   <dd>

    <span class="simpara">
     
    </span>
   </dd>

  </dt>

  <dt>

   <span class="term">
    <b><tt>DC_CALL_STD_BO</tt></b> 
    (<a href="language.types.integer.html" class="type integer">integer</a>)
   </span>
   <dd>

    <span class="simpara">
     
    </span>
   </dd>

  </dt>

  <dt>

   <span class="term">
    <b><tt>DC_CALL_STD_MS</tt></b> 
    (<a href="language.types.integer.html" class="type integer">integer</a>)
   </span>
   <dd>

    <span class="simpara">
     
    </span>
   </dd>

  </dt>

  <dt>

   <span class="term">
    <b><tt>DC_CALL_STD_M8</tt></b> 
    (<a href="language.types.integer.html" class="type integer">integer</a>)
   </span>
   <dd>

    <span class="simpara">
     
    </span>
   </dd>

  </dt>

  <dt>

   <span class="term">
    <b><tt>DC_FLAG_ARGPTR</tt></b> 
    (<a href="language.types.integer.html" class="type integer">integer</a>)
   </span>
   <dd>

    <span class="simpara">
     
    </span>
   </dd>

  </dt>

 </dl>

</div>



   
   <div id="w32api.examples" class="section">
    <h2 class="title">例</h2>
    <p class="para">
     以下の例は、システムの実行時間を取得し、メッセージボックスに
     表示するものです。
    </p>
    <div class="example">
     <p><b>Example#1 uptime を取得し、メッセージボックスに表示する</b></p>
     <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #FF8000">//&nbsp;必要な定数を定義します。これは<br />//&nbsp;Visual&nbsp;Studio/Tools/Winapi/WIN32API.txt&nbsp;から取得できます。<br /></span><span style="color: #0000BB">define</span><span style="color: #007700">(</span><span style="color: #DD0000">"MB_OK"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">//&nbsp;拡張モジュールを読み込みます。<br /></span><span style="color: #0000BB">dl</span><span style="color: #007700">(</span><span style="color: #DD0000">"php_w32api.dll"</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">//&nbsp;kernel32.dll&nbsp;の&nbsp;GetTickCount&nbsp;関数を登録します。<br /></span><span style="color: #0000BB">w32api_register_function</span><span style="color: #007700">(</span><span style="color: #DD0000">"kernel32.dll"</span><span style="color: #007700">,&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">"GetTickCount"</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">"long"</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br /></span><span style="color: #FF8000">//&nbsp;User32.dll&nbsp;の&nbsp;MessageBoxA&nbsp;関数を登録します。<br /></span><span style="color: #0000BB">w32api_register_function</span><span style="color: #007700">(</span><span style="color: #DD0000">"User32.dll"</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">"MessageBoxA"</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">"long"</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">//&nbsp;uptime&nbsp;情報を取得します。<br /></span><span style="color: #0000BB">$ticks&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">GetTickCount</span><span style="color: #007700">();<br /><br /></span><span style="color: #FF8000">//&nbsp;それを読みやすい形式に変換します。<br /></span><span style="color: #0000BB">$secs&nbsp;&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">floor</span><span style="color: #007700">(</span><span style="color: #0000BB">$ticks&nbsp;</span><span style="color: #007700">/&nbsp;</span><span style="color: #0000BB">1000</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$mins&nbsp;&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">floor</span><span style="color: #007700">(</span><span style="color: #0000BB">$secs&nbsp;</span><span style="color: #007700">/&nbsp;</span><span style="color: #0000BB">60</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$hours&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">floor</span><span style="color: #007700">(</span><span style="color: #0000BB">$mins&nbsp;</span><span style="color: #007700">/&nbsp;</span><span style="color: #0000BB">60</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">$str&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">sprintf</span><span style="color: #007700">(</span><span style="color: #DD0000">"You&nbsp;have&nbsp;been&nbsp;using&nbsp;your&nbsp;computer&nbsp;for:"&nbsp;</span><span style="color: #007700">.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">"\r\n&nbsp;%d&nbsp;Milliseconds,&nbsp;or&nbsp;\r\n&nbsp;%d&nbsp;Seconds"&nbsp;</span><span style="color: #007700">.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">"or&nbsp;\r\n&nbsp;%d&nbsp;mins&nbsp;or\r\n&nbsp;%d&nbsp;hours&nbsp;%d&nbsp;mins."</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$ticks</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$secs</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$mins</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$hours</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$mins&nbsp;</span><span style="color: #007700">-&nbsp;(</span><span style="color: #0000BB">$hours</span><span style="color: #007700">*</span><span style="color: #0000BB">60</span><span style="color: #007700">));<br /><br /></span><span style="color: #FF8000">//&nbsp;OK&nbsp;ボタンと&nbsp;uptime&nbsp;のみのメッセージボックスを表示します。<br /></span><span style="color: #0000BB">MessageBoxA</span><span style="color: #007700">(</span><span style="color: #0000BB">NULL</span><span style="color: #007700">,&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$str</span><span style="color: #007700">,&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">"Uptime&nbsp;Information"</span><span style="color: #007700">,&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">MB_OK</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
     </div>

    </div>
   </div>
  </div>











































 <h2>目次</h2><ul class="chunklist chunklist_reference"><li><a href="function.w32api-deftype.html">w32api_deftype</a> ― 他の w32api_functions で使用するために型を定義する</li><li><a href="function.w32api-init-dtype.html">w32api_init_dtype</a> ― データ型 typename のインスタンスを作成し、そこに渡された値を代入する</li><li><a href="function.w32api-invoke-function.html">w32api_invoke_function</a> ― 関数名の後ろに指定された引数を指定し、関数 funcname を実行する</li><li><a href="function.w32api-register-function.html">w32api_register_function</a> ― ライブラリの関数 function_name を PHP に登録する</li><li><a href="function.w32api-set-call-method.html">w32api_set_call_method</a> ― 使用するコール方式を設定する</li></ul>
</div>
<hr /><div style="text-align: center;">
 <div class="prev" style="float: left;"><a href="function.vpopmail-set-user-quota.html">vpopmail_set_user_quota</a></div>
 <div class="next" style="float: right;"><a href="function.w32api-deftype.html">w32api_deftype</a></div>
 <div class="up"><a href="funcref.html">関数リファレンス</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div></body></html>
