<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <title>Sun, iPlanet, Netscape サーバ（Sun Solaris 用）</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
 </head>
 <body><div style="text-align: center;">
 <div class="prev" style="float: left;"><a href="install.unix.fhttpd.html">fhttpd サーバ</a></div>
 <div class="next" style="float: right;"><a href="install.unix.commandline.html">CGI およびコマンドライン</a></div>
 <div class="up"><a href="install.unix.html">Unix システムへのインストール</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div><hr /><div id="install.unix.sun" class="sect1">
    <h2 class="title">Sun, iPlanet, Netscape サーバ（Sun Solaris 用）</h2>
    <p class="para">
      このセクションでは、Sun Solaris 上の Sun Java System Web Server, Sun ONE Web Server, 
      iPlanet and Netscape server に PHP をインストールする際の
      手引きと注意事項について説明します。
    </p>
    <p class="para">
     PHP 4.3.3 より、<a href="ref.nsapi.html" class="link">NSAPI モジュール</a> を使って 
     <a href="install.unix.sun.html#install.unix.sun.specialpages" class="link">独自エラーページ および
     ファイル一覧表示ページの生成</a> が可能です。 Apache 互換の関数も追加されています。 
     また、これらの Web サーバについての
     <a href="install.unix.sun.html#install.unix.sun.notes" class="link">サブリクエストに関する注意</a> も参照してください。
    </p>
    <p class="para">
     Netscape Enterprise Server (NES) への PHP のインストールに関しては
     <a href="http://benoit.noss.free.fr/php/install-php4.html" class="link external">&raquo; http://benoit.noss.free.fr/php/install-php4.html</a> にも情報があります。
    </p>
    
    <p class="para">
     Sun JSWS/Sun ONE WS/iPlanet/Netscape Web サーバ用に PHP をビルド
     するには、<a href="configure.html#configure.with-nsapi" class="link">--with-nsapi=[DIR]</a>
     オプションに適切なインストールディレクトリを指定してください。
     デフォルトのディレクトリは、通常、<var class="filename">/opt/netscape/suitespot/</var>
     です。
     <var class="filename">/php-xxx-version/sapi/nsapi/nsapi-readme.txt</var> も参照してください。
    </p>
    <p class="para">
     <ol class="orderedlist">
      <li class="listitem">
       <p class="para">
        以下のパッケージを、<a href="http://www.sunfreeware.com/" class="link external">&raquo; 
        http://www.sunfreeware.com/</a> や他のダウンロードサイトから取得し、
        インストールします。
        <ul class="simplelist">
         <li class="member"><var class="filename">autoconf-2.13</var></li>
         <li class="member"><var class="filename">automake-1.4</var></li>
         <li class="member"><var class="filename">bison-1_25-sol26-sparc-local</var></li>
         <li class="member"><var class="filename">flex-2_5_4a-sol26-sparc-local</var></li>
         <li class="member"><var class="filename">gcc-2_95_2-sol26-sparc-local</var></li>
         <li class="member"><var class="filename">gzip-1.2.4-sol26-sparc-local</var></li>
         <li class="member"><var class="filename">m4-1_4-sol26-sparc-local</var></li>
         <li class="member"><var class="filename">make-3_76_1-sol26-sparc-local</var></li>
         <li class="member">
          <var class="filename">mysql-3.23.24-beta</var> (mysql サポートが必要な場合)
         </li>
         <li class="member"><var class="filename">perl-5_005_03-sol26-sparc-local</var></li>
         <li class="member"><var class="filename">tar-1.13</var> (GNU tar)</li>
        </ul>
       </p>
      </li>
      <li class="listitem">
       <span class="simpara">
        パスを適切に設定します
        ( <i class="literal">PATH=.:/usr/local/bin:/usr/sbin:/usr/bin:/usr/ccs/bin</i> )。
        そして、<strong class="userinput"><code>export PATH</code></strong>
とし、パスを有効にします。
       </span>
      </li>
      <li class="listitem">
       <span class="simpara">
        <strong class="userinput"><code>gunzip php-x.x.x.tar.gz</code></strong>
 (.gz 配布の場合のみ)
       </span>
      </li>
      <li class="listitem">
       <span class="simpara">
        <strong class="userinput"><code>tar xvf php-x.x.x.tar</code></strong>

       </span>
      </li>
      <li class="listitem">
       <span class="simpara">
        PHP を展開したディレクトリに移動します
        <strong class="userinput"><code>cd ../php-x.x.x</code></strong>

       </span>
      </li>
      <li class="listitem">
       <p class="para">
        以下のステップを実施します。
        <var class="filename">/opt/netscape/suitespot/</var> は
        netscape サーバがインストールされている場所です。
        異なる場合は、適切なパスに変更してください。
        <div class="example-contents">
<div class="cdata"><pre>
./configure --with-mysql=/usr/local/mysql \
--with-nsapi=/opt/netscape/suitespot/ \
--enable-libgcc
</pre></div>
        </div>

       </p>
      </li>
      <li class="listitem">
       <span class="simpara">
        <strong class="command">make</strong> を実行し、その後 <strong class="command">make install</strong>
        を実行します。
       </span>
      </li>
     </ol>
    </p>
    <p class="para">
     基本インストールを実行したら、適当な readme ファイルを参照してください。
     いくつかの追加インストール手順を実行する必要があるかもしれません。
    </p>
    <p class="formalpara">
     <h5 class="title">Sun/iPlanet/Netscape の設定手順</h5>
     <p class="para">
      まず、共有ライブラリの探索のために、環境変数
      LD_LIBRARY_PATH にパスをいくつか追加する必要があります。
      Webサーバの開始スクリプトで行うのが最善でしょう。
      開始スクリプトは、通常 
      <var class="filename">/path/to/server/https-servername/start</var>
      にあります。
      また、<var class="filename">/path/to/server/https-servername/config/</var>
      にある設定ファイルの編集も必要です。
      <ol class="orderedlist">
       <li class="listitem">
        <p class="para">
         <var class="filename">mime.types</var>に次の行を追加します
         (administration server で行えます。)
         <div class="example-contents"><pre>
<div class="cdata"><pre>
type=magnus-internal/x-httpd-php exts=php
</pre></div>
         </pre></div>
        </p>
       </li>
       <li class="listitem">
        <p class="para">
         <var class="filename">magnus.conf</var> (サーバ&gt;= 6の場合) または
         <var class="filename">obj.conf</var> (サーバ&lt; 6の場合) を編集し、
         以下の行を追加します。
         ここで、shlib はシステムにより異なります。
         <var class="filename">/opt/netscape/suitespot/bin/libphp4.so</var>
         等となるでしょう。
         <i class="literal">mime types init</i> の後に置いてください。
         <div class="example-contents">
<div class="cdata"><pre>
Init fn=&quot;load-modules&quot; funcs=&quot;php4_init,php4_execute,php4_auth_trans&quot; shlib=&quot;/opt/netscape/suitespot/bin/libphp4.so&quot;
Init fn=&quot;php4_init&quot; LateInit=&quot;yes&quot; errorString=&quot;Failed to initialize PHP!&quot; [php_ini=&quot;/path/to/php.ini&quot;]
</pre></div>
         </div>

         (PHP &gt;= 4.3.3) <i class="literal">php_ini</i> パラメータはオプションですが、 
         これを指定することにより、Web サーバの設定ファイルがあるフォルダに 
         <var class="filename">php.ini</var> を置くことが可能になります。
        </p>
       </li>
       <li class="listitem">
        <p class="para">
         <var class="filename">obj.conf</var> のデフォルトオブジェクトを設定します 
         （バージョン 6 以降の仮想サーバの場合は
         <var class="filename">vserver.obj.conf</var>。）
         <div class="example-contents">
<div class="cdata"><pre>
&lt;Object name=&quot;default&quot;&gt;
.
.
.
.#NOTE this next line should happen after all &#039;ObjectType&#039; and before all &#039;AddLog&#039; lines
Service fn=&quot;php4_execute&quot; type=&quot;magnus-internal/x-httpd-php&quot; [inikey=value inikey=value ...]
.
.
&lt;/Object&gt;
</pre></div>
         </div>

         (PHP &gt;= 4.3.3) 追加のパラメータとして、いくつかの特別な <var class="filename">php.ini</var> 値を 
         追加することができます。例えば、コンテキスト <i class="literal">php4_execute</i> に対して 
         <i class="literal">docroot=&quot;/path/to/docroot&quot;</i> を設定するなどです。
         また、論理値の場合、0/1 を値として使用してください。 
         <i class="literal">&quot;On&quot;,&quot;Off&quot;,...</i> では正しく動作しません。
         例えば、<i class="literal">zlib.output_compression=&quot;On&quot;</i> ではなく、 
         <i class="literal">zlib.output_compression=1</i> とします。
        </p>
       </li>
       <li class="listitem">
        <p class="para">
         以下は、（<var class="filename">cgi-bin</var> ディレクトリ のように）
         PHP スクリプトだけが置かれるディレクトリを設定したい場合にのみ必要です。
         <div class="example-contents">
<div class="cdata"><pre>
&lt;Object name=&quot;x-httpd-php&quot;&gt;
ObjectType fn=&quot;force-type&quot; type=&quot;magnus-internal/x-httpd-php&quot;
Service fn=php4_execute [inikey=value inikey=value ...]
&lt;/Object&gt;
</pre></div>
         </div>

         こうしておくと、Administration Server に特定のディレクトリを設定し、 
         これをスタイル <i class="literal">x-httpd-php</i> に割り付けることができます。
         このディレクトリの中にあるすべてのファイルは PHP スクリプト として実行されます。 
         これは、ファイルの拡張子を <var class="filename">.html</var> に変更し、
         PHP が使用されている事を隠したい場合に有用です。
        </p>
       </li>
       <li class="listitem">
        <p class="para">
         認証を設定します。PHP による認証は他の認証と併用することはできません。
         すべての認証は、PHP スクリプトに渡されます。
         サーバ全体に対して PHP 認証を設定する場合は、以下の行を追加してください。
         <div class="example-contents">
<div class="cdata"><pre>
&lt;Object name=&quot;default&quot;&gt;
AuthTrans fn=php4_auth_trans
.
.
.
&lt;/Object&gt;
</pre></div>
         </div>

        </p>
       </li>
       <li class="listitem">
        <p class="para">
         単一のディレクトリでのみ PHP による認証を行う場合は、次の行を追加します。
         <div class="example-contents">
<div class="cdata"><pre>
&lt;Object ppath=&quot;d:\path\to\authenticated\dir\*&quot;&gt;
AuthTrans fn=php4_auth_trans
&lt;/Object&gt;
</pre></div>
         </div>

        </p>
       </li>
      </ol>
     </p>
    </p>
    <blockquote><p><b class="note">注意</b>: 
     
      PHP が使用するスタックサイズは Web サーバの設定に依存します。 
      非常に大きい PHP スクリプトを実行させた際にクラッシュが発生する場合は、 
      Administration Server でスタックサイズ（&quot;MAGNUS EDITOR&quot;） を大きくすると良いでしょう。
     <br />
    </p></blockquote>
   
   <div id="install.unix.sun.phpini" class="sect2">
    <h3 class="title">CGI 環境変数と php.ini の変更</h3>
    <p class="para">
     Sun JSWS/Sun ONE WS/iPlanet/Netscape がマルチスレッドの Web サーバだという事が 
     PHP スクリプトを書く際に重要になります。すべてのリクエストは同一の 
     （Web サーバ自体の）プロセス空間で実行され、そのプロセス空間は 1 つの環境変数しか
     持っていません。PATH_INFO  や HTTP_HOST などの CGI 変数を取得する場合、 
     PHP 3.x で行っていたような古い方法、つまり getenv() 関数を使用する方法や他の同等な方法
     （グローバル変数の登録機能、 $_ENV  等）を使うのは正しい方法ではありません。
     Web サーバの環境変数をただ単に取得するだけと、
     正しい CGI 変数は得られないのです。
    </p>
    <blockquote><p><b class="note">注意</b>: 
     
      なぜ正しくない CGI 変数が登録されているのでしょうか？
     <br />
     
      それは、Web サーバのプロセスを Administration Server から起動させる際、
      Web サーバの起動スクリプトが CGI スクリプトとして実行されるためです。したがって、
      起動された Web サーバの環境変数には CGI 変数も含まれることになります。
      Administration Server 以外から Web サーバを起動してみればこのことをテストできるでしょう。
      ルートユーザでコマンドラインを使って、手動で起動してみると、CGI 変数らしき
      環境変数が登録されないことが確認できるでしょう。
     <br />
    </p></blockquote>
    <p class="para">
     PHP 4.x のスクリプトで CGI 変数を取得する場合は、スーパーグローバル
     <i class="literal">$_SERVER</i> を用いるのが正しい方法です。また、<i class="literal">$HTTP_HOST</i>
     などを使う古いスクリプトを使用する場合は、<var class="filename">php.ini</var> で <i class="literal">register_globals</i> 
     をオンにし、変数のパースの順番 (<i class="literal">variables_order</i>) を変更してください
     （<i class="literal">&quot;E&quot;</i> を削除。環境変数を読み込む必要は無いため。）
     <div class="example-contents">
<div class="cdata"><pre>
variables_order = &quot;GPCS&quot;
register_globals = On
</pre></div>
     </div>

    </p>
   </div>
   
   <div id="install.unix.sun.specialpages" class="sect2">
    <h3 class="title">独自エラーページおよびファイル一覧表示ページ (PHP &gt;= 4.3.3)</h3>
    <p class="para">
     PHP を使って、<i class="literal">&quot;404 Not Found&quot;</i> などに対するエラーページを生成することが
     できます。オーバーライドしたいすべてのエラーページ対して、以下の行を
     <var class="filename">obj.conf</var> 中のオブジェクトに追加してください。
     <div class="example-contents">
<div class="cdata"><pre>
Error fn=&quot;php4_execute&quot; code=XXX script=&quot;/path/to/script.php&quot; [inikey=value inikey=value...]
</pre></div>
     </div>

     ここで、<i class="literal">XXX</i> は HTTP のエラーコードです。
     追加したものと干渉する <i class="literal">Error</i> ディレクティブは削除してください。
     発生するすべてのエラーに対応するページを設定したい場合は、
     <i class="literal">code</i> パラメータを省略してください。スクリプトで HTTP ステータス
     コードを取得するには、 <i class="literal">$_SERVER[&#039;ERROR_TYPE&#039;]</i> を使用します。
    </p>
    <p class="para">
     独自のファイル一覧表示ページを PHP を使って生成することも可能です。
     ファイル一覧表示を行う PHP スクリプトを作成し、<var class="filename">obj.conf</var> の
     <i class="literal">type=&quot;magnus-internal/directory&quot;</i> の行に
     書かれているデフォルトのサービスを以下のように置き換えます。
     <div class="example-contents">
<div class="cdata"><pre>
Service fn=&quot;php4_execute&quot; type=&quot;magnus-internal/directory&quot; script=&quot;/path/to/script.php&quot; [inikey=value inikey=value...]
</pre></div>
     </div>

     エラーページ、ファイル一覧表示ページのいずれでも、元の URI および
     変換後の URI は、それぞれ、<i class="literal">$_SERVER[&#039;PATH_INFO&#039;]</i> および
     <i class="literal">$_SERVER[&#039;PATH_TRANSLATED&#039;]</i> に格納されます。
    </p>
   </div>
   
   <div id="install.unix.sun.notes" class="sect2">
    <h3 class="title"><a href="function.nsapi-virtual.html" class="function">nsapi_virtual()</a> および サブリクエストに関する注意 (PHP &gt;= 4.3.3)</h3>
    <p class="para">
     NSAPI モジュールは、現在、<a href="function.nsapi-virtual.html" class="function">nsapi_virtual()</a> 関数
     (エイリアス: <a href="function.virtual.html" class="function">virtual()</a>) をサポートしており、
     Web サーバへサブリクエストを行い、結果を Web ページへ挿入することができます。
     ただし、この関数は NSAPI ライブラリの文書化されていない機能を若干使用しています。
     モジュールは、自動的に必要な関数群を探し、可能であればそれらの関数を
     使用ます。もし使用可能でなければ、<a href="function.nsapi-virtual.html" class="function">nsapi_virtual()</a> 関数は
     使用不可となります。
    </p>
    <blockquote><p><b class="note">注意</b>: 
     
      <a href="function.nsapi-virtual.html" class="function">nsapi_virtual()</a> サポートは「実験的」な機能です。
     <br />
    </p></blockquote>
   </div>   
  </div><hr /><div style="text-align: center;">
 <div class="prev" style="float: left;"><a href="install.unix.fhttpd.html">fhttpd サーバ</a></div>
 <div class="next" style="float: right;"><a href="install.unix.commandline.html">CGI およびコマンドライン</a></div>
 <div class="up"><a href="install.unix.html">Unix システムへのインストール</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div></body></html>
