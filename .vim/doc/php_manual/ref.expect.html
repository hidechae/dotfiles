<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <title>Expect 関数</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
 </head>
 <body><div style="text-align: center;">
 <div class="prev" style="float: left;"><a href="function.read-exif-data.html">read_exif_data</a></div>
 <div class="next" style="float: right;"><a href="function.expect-expectl.html">expect_expectl</a></div>
 <div class="up"><a href="funcref.html">関数リファレンス</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div><hr /><div>
  <h1 class="title">Expect 関数</h1>
  

  <div class="partintro">
   <div id="expect.intro" class="section">
    <h2 class="title">導入</h2>
    <p class="para">
     この拡張モジュールは、PTY を経由したプロセス同士の対話機能を提供します。
     <a href="ref.filesystem.html" class="link">ファイルシステム関数</a> で
     <a href="wrappers.expect.html" class="link"><i class="literal">expect://</i> ラッパ</a>
     を利用すれば、シンプルでより直感的なインターフェースが利用できるでしょう。
    </p>
   </div>
   
   <div id="expect.requirements" class="section">
    <h2 class="title">要件</h2>
    <p class="para">
     このモジュールは <a href="http://expect.nist.gov/" class="link external">&raquo; expect</a> ライブラリの
     関数を使用します。libexpect バージョン &gt;= 5.43.0 が必要です。
    </p>
   </div>
   
   


<div id="expect.installation" class="section">
 <h2 class="title">インストール手順</h2>
 <p class="para">
  この <a href="http://pecl.php.net/" class="link external">&raquo; PECL</a> 拡張
モジュールは PHP にバンドルされていません。
  この PECL 拡張モジュールをインストールする方法は、
マニュアルの <a href="install.pecl.html" class="link">
PECL 拡張モジュールのインストール</a> という章にあります。
新規リリース・ダウンロード・ソースファイル・管理者情報・CHANGELOG
といった関連する情報については、次の場所にあります。
  <a href="http://pecl.php.net/package/expect" class="link external">&raquo; http://pecl.php.net/package/expect</a>.
 </p>
 <p class="para">
  PHP 4 の場合、この <acronym title="PHP Extension and Application Repository">PECL</acronym> 拡張モジュール
のソースは、PHP のソースの <var class="filename">ext/</var> ディレクトリ、または
上の <acronym title="PHP Extension and Application Repository">PECL</acronym> リンクで入手可能です。
  これらの関数を使用するには、<span class="option">--with-expect[=DIR]</span>
  オプションを使用して expect サポートつきで PHP をコンパイルする必要があります。
 </p>
 <p class="para">
  Windows ユーザは、これらの関数を使用するためには <var class="filename">php.ini</var> の中で
  <var class="filename">php_expect.dll</var> を有効にします。
  PHP 4 の場合、この <acronym title="Dynamic Link Library">DLL</acronym> は
PHP の Windows ダウンロードバイナリの <var class="filename">extensions/</var> ディレクトリ
にあります。
  
この <acronym title="PHP Extension and Application Repository">PECL</acronym> 拡張モジュール用の <acronym title="Dynamic Link Library">DLL</acronym>
は、<a href="http://www.php.net/downloads.php" class="link external">&raquo; PHP のダウンロード</a> ページあるいは
<a href="http://pecl4win.php.net/" class="link external">&raquo; http://pecl4win.php.net/</a> からダウンロードできます。
 </p>
</div>





   


<div id="expect.configuration" class="section">
 <h2 class="title">実行時設定</h2>
 <p class="simpara">
<var class="filename">php.ini</var> の設定により動作が変化します。
</p>
 <p class="para">
  expect 拡張モジュールを設定するために、
  <a href="configuration.html#configuration.file" class="link">設定ファイル</a> <var class="filename">php.ini</var> に
  設定項目が用意されています。
  <table border="5">
   <caption><b>Expect 設定オプション</b></caption>
   <colgroup>

    <thead valign="middle">
     <tr valign="middle">
      <th colspan="1">名前</th>
      <th colspan="1">デフォルト</th>
      <th colspan="1">変更可能</th>
      <th colspan="1">変更履歴</th>
     </tr>

    </thead>

    <tbody valign="middle">
     <tr valign="middle">
      <td colspan="1" rowspan="1" align="left">expect.timeout</td>
      <td colspan="1" rowspan="1" align="left">&quot;10&quot;</td>
      <td colspan="1" rowspan="1" align="left">PHP_INI_ALL</td>
      <td class="empty">&nbsp;</td>
     </tr>

     <tr valign="middle">
      <td colspan="1" rowspan="1" align="left">expect.loguser</td>
      <td colspan="1" rowspan="1" align="left">&quot;1&quot;</td>
      <td colspan="1" rowspan="1" align="left">PHP_INI_ALL</td>
      <td class="empty">&nbsp;</td>
     </tr>

     <tr valign="middle">
      <td colspan="1" rowspan="1" align="left">expect.logfile</td>
      <td colspan="1" rowspan="1" align="left">&quot;&quot;</td>
      <td colspan="1" rowspan="1" align="left">PHP_INI_ALL</td>
      <td class="empty">&nbsp;</td>
     </tr>

    </tbody>
   </colgroup>

  </table>

  PHP_INI_* 定数の詳細および定義については
<a href="ini.html" class="xref">php.ini ディレクティブ</a> を参照してください。
 </p>
 
 <p class="para">以下に設定ディレクティブに関する
簡単な説明を示します。</p>
 
 <p class="para">
  <dl>

   <dt id="ini.expect.timeout">
    <span class="term">
     <i><tt class="parameter">expect.timeout</tt></i>

     <a href="language.types.integer.html" class="type integer">integer</a>
    </span>
    <dd>

     <p class="para">
      データを待ち受ける際のタイムアウト時間です。
      <a href="function.expect-expectl.html" class="function">expect_expectl()</a> 関数で使用されます。
     </p>
     <p class="para">
      &quot;-1&quot; を指定すると、タイムアウトを発生させないようにします。
     </p>
     <blockquote><p><b class="note">注意</b>: 
      
       &quot;0&quot; を指定すると、<a href="function.expect-expectl.html" class="function">expect_expectl()</a> 関数は
       結果を直ちに返します。
      <br />
     </p></blockquote>
    </dd>

   </dt>


   <dt id="ini.expect.loguser">
    <span class="term">
     <i><tt class="parameter">expect.loguser</tt></i>

     <a href="language.types.boolean.html" class="type boolean">boolean</a>
    </span>
    <dd>

     <p class="para">
      expect が、子プロセスの出力を標準出力に送るかどうかを指定します。
      典型的な対話型プログラムは入力した内容を表示するので、これを使用すれば
      対話の両方の側を表示することができます。
     </p>
    </dd>

   </dt>


   <dt id="ini.expect.logfile">
    <span class="term">
     <i><tt class="parameter">expect.logfile</tt></i>

     <a href="language.types.string.html" class="type string">string</a>
    </span>
    <dd>

     <p class="para">
      子プロセスの出力内容が書き込まれるファイルの名前。もしファイルが
      存在しない場合は新しく作成されます。
     </p>
     <blockquote><p><b class="note">注意</b>: 
      
       この設置が空欄でなかった場合、
       <a href="ref.expect.html#ini.expect.loguser" class="link">expect.loguser</a> の設定内容に
       かかわらず出力が書き込まれます。
      <br />
     </p></blockquote>
    </dd>

   </dt>


  </dl>

 </p>
</div>




   <div id="expect.resources" class="section">
    <h2 class="title">リソース型</h2>
    <p class="para">
     <a href="function.expect-popen.html" class="function">expect_popen()</a> は、オープンした PTY
     ストリームを返します。これを <a href="function.expect-expectl.html" class="function">expect_expectl()</a>
     で使用します。
    </p>
   </div>

   


<div id="expect.constants" class="section">
 <h2 class="title">定義済み定数</h2>
 <p class="simpara">
以下の定数が定義されています。
この関数の拡張モジュールが PHP 組み込みでコンパイルされているか、
実行時に動的にロードされている場合のみ使用可能です。
</p>
 <dl>

  <dt id="constants.expect.exp_glob">
   <span class="term">
    <b><tt>EXP_GLOB</tt></b>
     (<a href="language.types.integer.html" class="type integer">integer</a>)
   </span>
   <dd>

    <span class="simpara">
     パターンが、glob 形式の文字列パターンであることを示します。
    </span>
   </dd>

  </dt>

  <dt id="constants.expect.exp_exact">
   <span class="term">
    <b><tt>EXP_EXACT</tt></b>
     (<a href="language.types.integer.html" class="type integer">integer</a>)
   </span>
   <dd>

    <span class="simpara">
     パターンが、単なる文字列であることを示します。
    </span>
   </dd>

  </dt>

  <dt id="constants.expect.exp_regexp">
   <span class="term">
    <b><tt>EXP_REGEXP</tt></b>
     (<a href="language.types.integer.html" class="type integer">integer</a>)
   </span>
   <dd>

    <span class="simpara">
     パターンが、正規表現形式の文字列パターンであることを示します。
    </span>
   </dd>

  </dt>

  <dt id="constants.expect.exp_eof">
   <span class="term">
    <b><tt>EXP_EOF</tt></b>
     (<a href="language.types.integer.html" class="type integer">integer</a>)
   </span>
   <dd>

    <span class="simpara">
     EOF に到達した際に <a href="function.expect-expectl.html" class="function">expect_expectl()</a> が返す値です。
    </span>
   </dd>

  </dt>

  <dt id="constants.expect.exp_timeout">
   <span class="term">
    <b><tt>EXP_TIMEOUT</tt></b>
     (<a href="language.types.integer.html" class="type integer">integer</a>)
   </span>
   <dd>

    <span class="simpara">
     <a href="ref.expect.html#ini.expect.timeout" class="link">expect.timeout</a> で指定した秒数を
     こえた際に <a href="function.expect-expectl.html" class="function">expect_expectl()</a> が返す値です。
    </span>
   </dd>

  </dt>

  <dt id="constants.expect.exp_fullbuffer">
   <span class="term">
    <b><tt>EXP_FULLBUFFER</tt></b>
     (<a href="language.types.integer.html" class="type integer">integer</a>)
   </span>
   <dd>

    <span class="simpara">
     一致するパターンがなかった際に
     <a href="function.expect-expectl.html" class="function">expect_expectl()</a> が返す値です。
    </span>
   </dd>

  </dt>

 </dl>

</div>




   <div id="expect.examples" class="section">
    <h2 class="title">例</h2>
    <p class="para">
     この例ではリモートホストに SSH 経由で接続し、接続先の稼働時間を表示します。
    </p>
    <div class="example">
     <p><b>Example#1 Expect の使用例</b></p>
     <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />ini_set&nbsp;</span><span style="color: #007700">(</span><span style="color: #DD0000">"expect.loguser"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"Off"</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">$stream&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">fopen&nbsp;</span><span style="color: #007700">(</span><span style="color: #DD0000">"expect://ssh&nbsp;root@remotehost&nbsp;uptime"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"r"</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">$cases&nbsp;</span><span style="color: #007700">=&nbsp;array&nbsp;(<br />&nbsp;&nbsp;array&nbsp;(</span><span style="color: #0000BB">0&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #DD0000">"password:"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">1&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">PASSWORD</span><span style="color: #007700">)<br />);<br /><br />switch&nbsp;(</span><span style="color: #0000BB">expect_expectl&nbsp;</span><span style="color: #007700">(</span><span style="color: #0000BB">$stream</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$cases</span><span style="color: #007700">))&nbsp;{<br />&nbsp;case&nbsp;</span><span style="color: #0000BB">PASSWORD</span><span style="color: #007700">:<br />&nbsp;&nbsp;</span><span style="color: #0000BB">fwrite&nbsp;</span><span style="color: #007700">(</span><span style="color: #0000BB">$stream</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"password\n"</span><span style="color: #007700">);<br />&nbsp;&nbsp;break;<br />&nbsp;<br />&nbsp;default:<br />&nbsp;&nbsp;die&nbsp;(</span><span style="color: #DD0000">"リモートホストへの接続時にエラーが発生しました!\n"</span><span style="color: #007700">);<br />}<br /><br />while&nbsp;(</span><span style="color: #0000BB">$line&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">fgets&nbsp;</span><span style="color: #007700">(</span><span style="color: #0000BB">$stream</span><span style="color: #007700">))&nbsp;{<br />&nbsp;&nbsp;print&nbsp;</span><span style="color: #0000BB">$line</span><span style="color: #007700">;<br />}<br /></span><span style="color: #0000BB">fclose&nbsp;</span><span style="color: #007700">(</span><span style="color: #0000BB">$stream</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
     </div>

    </div>

    <p class="para">
     次の例は、リモートホストに接続して
     インストールされている OS が 32 ビットか 64 ビットかを確認し、
     それぞれのパッケージのアップデートを実行します。
    </p>
    <div class="example">
     <p><b>Example#2 もうひとつの Expect の使用例</b></p>
     <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />ini_set&nbsp;</span><span style="color: #007700">(</span><span style="color: #DD0000">"expect.timeout"</span><span style="color: #007700">,&nbsp;-</span><span style="color: #0000BB">1</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">ini_set&nbsp;</span><span style="color: #007700">(</span><span style="color: #DD0000">"expect.loguser"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"Off"</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">$stream&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">expect_popen&nbsp;</span><span style="color: #007700">(</span><span style="color: #DD0000">"ssh&nbsp;root@remotehost"</span><span style="color: #007700">);<br /><br />while&nbsp;(</span><span style="color: #0000BB">true</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;switch&nbsp;(</span><span style="color: #0000BB">expect_expectl&nbsp;</span><span style="color: #007700">(</span><span style="color: #0000BB">$stream</span><span style="color: #007700">,&nbsp;array&nbsp;(<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;array&nbsp;(</span><span style="color: #DD0000">"password:"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">PASSWORD</span><span style="color: #007700">),&nbsp;</span><span style="color: #FF8000">//&nbsp;SSH&nbsp;がパスワードを問い合わせます<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">array&nbsp;(</span><span style="color: #DD0000">"yes/no)?"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">YESNO</span><span style="color: #007700">),&nbsp;</span><span style="color: #FF8000">//&nbsp;SSH&nbsp;がホストエントリを保存するかどうかを問い合わせます<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">array&nbsp;(</span><span style="color: #DD0000">"~$&nbsp;"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">SHELL</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">EXP_EXACT</span><span style="color: #007700">),&nbsp;</span><span style="color: #FF8000">//&nbsp;シェルにたどり着きました!<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">)))&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;</span><span style="color: #0000BB">PASSWORD</span><span style="color: #007700">:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">fwrite&nbsp;</span><span style="color: #007700">(</span><span style="color: #0000BB">$stream</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"secret\n"</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;</span><span style="color: #0000BB">YESNO</span><span style="color: #007700">:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">fwrite&nbsp;</span><span style="color: #007700">(</span><span style="color: #0000BB">$stream</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"yes\n"</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;</span><span style="color: #0000BB">SHELL</span><span style="color: #007700">:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">fwrite&nbsp;</span><span style="color: #007700">(</span><span style="color: #0000BB">$stream</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"uname&nbsp;-a\n"</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;(</span><span style="color: #0000BB">true</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;switch&nbsp;(</span><span style="color: #0000BB">expect_expectl&nbsp;</span><span style="color: #007700">(</span><span style="color: #0000BB">$stream</span><span style="color: #007700">,&nbsp;array&nbsp;(<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;array&nbsp;(</span><span style="color: #DD0000">"~$&nbsp;"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">SHELL</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">EXP_EXACT</span><span style="color: #007700">),&nbsp;</span><span style="color: #FF8000">//&nbsp;シェルにたどり着きました!<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">array&nbsp;(</span><span style="color: #DD0000">"^Linux.*$"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">UNAME</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">EXP_REGEXP</span><span style="color: #007700">),&nbsp;</span><span style="color: #FF8000">//&nbsp;uname&nbsp;-a&nbsp;の出力<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">),&nbsp;</span><span style="color: #0000BB">$match</span><span style="color: #007700">))&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;</span><span style="color: #0000BB">UNAME</span><span style="color: #007700">:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$uname&nbsp;</span><span style="color: #007700">.=&nbsp;</span><span style="color: #0000BB">$match</span><span style="color: #007700">[</span><span style="color: #0000BB">0</span><span style="color: #007700">];<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;</span><span style="color: #0000BB">SHELL</span><span style="color: #007700">:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;アップデートの実行<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if&nbsp;(</span><span style="color: #0000BB">strstr&nbsp;</span><span style="color: #007700">(</span><span style="color: #0000BB">$uname</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"x86_64"</span><span style="color: #007700">))&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">fwrite&nbsp;</span><span style="color: #007700">(</span><span style="color: #0000BB">$stream</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"rpm&nbsp;-Uhv&nbsp;http://mirrorsite/somepath/some_64bit.rpm\n"</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">fwrite&nbsp;</span><span style="color: #007700">(</span><span style="color: #0000BB">$stream</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"rpm&nbsp;-Uhv&nbsp;http://mirrorsite/somepath/some_32bit.rpm\n"</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">fwrite&nbsp;</span><span style="color: #007700">(</span><span style="color: #0000BB">$stream</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"exit\n"</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break&nbsp;</span><span style="color: #0000BB">2</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;</span><span style="color: #0000BB">EXP_TIMEOUT</span><span style="color: #007700">:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;</span><span style="color: #0000BB">EXP_EOF</span><span style="color: #007700">:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break&nbsp;</span><span style="color: #0000BB">2</span><span style="color: #007700">;<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;default:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;die&nbsp;(</span><span style="color: #DD0000">"エラーが発生しました!\n"</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break&nbsp;</span><span style="color: #0000BB">2</span><span style="color: #007700">;<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;</span><span style="color: #0000BB">EXP_TIMEOUT</span><span style="color: #007700">:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;</span><span style="color: #0000BB">EXP_EOF</span><span style="color: #007700">:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break&nbsp;</span><span style="color: #0000BB">2</span><span style="color: #007700">;<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;default:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;die&nbsp;(</span><span style="color: #DD0000">"エラーが発生しました!\n"</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />}<br /><br /></span><span style="color: #0000BB">fclose&nbsp;</span><span style="color: #007700">(</span><span style="color: #0000BB">$stream</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
     </div>

    </div>
   </div>
  </div>

















 <h2>目次</h2><ul class="chunklist chunklist_reference"><li><a href="function.expect-expectl.html">expect_expectl</a> ― プロセスの出力がパターンに一致する・指定した時間が経過する・
  あるいは EOF に達するのいずれかにあてはまるまで待ち続ける</li><li><a href="function.expect-popen.html">expect_popen</a> ― Bourne シェル経由でコマンドを実行し、プロセスへの PTY
  ストリームをオープンする</li></ul>
</div>
<hr /><div style="text-align: center;">
 <div class="prev" style="float: left;"><a href="function.read-exif-data.html">read_exif_data</a></div>
 <div class="next" style="float: right;"><a href="function.expect-expectl.html">expect_expectl</a></div>
 <div class="up"><a href="funcref.html">関数リファレンス</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div></body></html>
